library(bacsnp)
bac
bacsnp::bac.df
bac.df
library(bacsnp)
R CMD check
R CMD
devtools::use_vignette("asdf")
usethis::use_vignette("bacsnp")
usethis::use_vignette("bacsnp")
usethis::use_vignette("bacsnp")
library(bacsnp)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(bacsnp)
#bacfile <- system.file("extdata", "bac.vcf", package="bacsnp")
#bacdata <- readVcf(bacfile, "CpGV-M")
bacfile <- system.file("extdata", "bacE2.vcf", package="bacsnp")
bacdata <- readVcf(bacfile, "KM217577")
bacfile <- system.file("extdata", "bac.vcf", package="bacsnp")
bacdata <- readVcf(bacfile, "CpGV-M")
#bacfile <- system.file("extdata", "bacE2.vcf", package="bacsnp")
#bacdata <- readVcf(bacfile, "KM217577")
head(bac)
head(bac.df)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(bacsnp)
bacfile <- system.file("extdata", "bac.vcf", package="bacsnp")
bacdata <- readVcf(bacfile, "CpGV-M")
#bacfile <- system.file("extdata", "bacE2.vcf", package="bacsnp")
#bacdata <- readVcf(bacfile, "KM217577")
#head(bac.df)
bac.df <- vcf_to_df(bacdata)
devtools::document()
devtools::document()
library(VariantAnnotation)
library(IRanges)
library(bacsnp)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
bacfile <- system.file("extdata", "bac.vcf", package="bacsnp")
bacdata <- readVcf(bacfile, "CpGV-M")
#bacfile <- system.file("extdata", "bacE2.vcf", package="bacsnp")
#bacdata <- readVcf(bacfile, "KM217577")
bac.df <- vcf_to_df(bacdata)
head(bac.df)
tail(bac.df)
bac.df
bac <- bac.df
save(bac, file = "bac.RData")
library(bacsnp)
devtools::document()
library(bacsnp)
devtools::document()
library(bacsnp)
bac
devtools::document()
?raw_bacsnp
?vcf_to_df
library(bacsnp)
?vcf_to_df
?raw_bacvcf
devtools::document()
library(bacsnp)
?raw_bacvcf
bacsnp.plot()
devtools::document()
library(bacsnp)
?vcf_to_df
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(VariantAnnotation)
library(IRanges)
library(bacsnp)
bacfile <- system.file("extdata", "bac.vcf", package="bacsnp")
bacdata <- readVcf(bacfile, "CpGV-M")
#bacfile <- system.file("extdata", "bacE2.vcf", package="bacsnp")
#bacdata <- readVcf(bacfile, "KM217577")
head(bac)
bac.df <- vcf_to_df(bacdata)
head(bac.df)
tail(bac.df)
unique(bac.df$ISO)
length(unique(bac.df$POS))
unique(bac.df$POS)
hist(bac.df$REL.ALT1, xlim = c(0,1), breaks = 50)
hist(bac.df$REL.ALT2, xlim = c(0,0.1), breaks = 50)
hist(bac.df$REL.ALT3, xlim = c(0,0.01))
bac.f <- filter_snp_df(bac.df, min.abs.cov = 100, min.abs.alt = 10, min.rel.alt = 0.05)
bac.spec <- snp_specificity(bac.f, c("iM", "iS"),which.rel = "REL.ALT1")
bac.spec <- snp_specificity(bac.f, c("iIsolate1", "iIsolate1"),which.rel = "REL.ALT1")
bac.spec <- snp_specificity(bac.f, c("iIsolate1", "iIsolate2"),which.rel = "REL.ALT1")
bac.spec$combinations
head(bac.spec$data)
Ssnp <- bac.spec$data[bac.spec$data$ISO == "iIsolate1",]
Msnp <- bac.spec$data[bac.spec$data$ISO == "iIsolate2",]
Mixsnp <- bac.spec$data[bac.spec$data$ISO == "iIsolate3",]
Mixsnp <- Mixsnp[Mixsnp$GROUP.ID != "new",]
bacsnp.plot(Ssnp, col = "SPEC", genome.length = 123858, mark.repeats = FALSE)#, mark.lowGQ = 120, mark.lowQUAL = 400)
bacsnp.plot(Msnp, col = "SPEC", genome.length = 123858, mark.repeats = FALSE)#, mark.lowGQ = 120, mark.lowQUAL = 400)
bacsnp.plot(Mixsnp, col = "SPEC", genome.length = 123858, mark.repeats = FALSE)#, mark.lowGQ = 120, mark.lowQUAL = 400)
mplot <- bacsnp.plot(Msnp, col = "SPEC", genome.length = 123858, mark.repeats = FALSE)#, mark.lowGQ = 120, mark.lowQUAL = 400)
splot <- bacsnp.plot(Ssnp, col = "SPEC", genome.length = 123858, mark.repeats = FALSE)#, mark.lowGQ = 120, mark.lowQUAL = 400)
bplot <- bacsnp.plot(Mixsnp, col = "SPEC", genome.length = 123858, mark.repeats = FALSE)#, mark.lowGQ = 120, mark.lowQUAL = 400)
SPEC <- unique(bac.spec$data$SPEC)[1:3]
mean.freq <- function(df, specs){
mean.spec <- c(rep(0,length(specs)))
names(mean.spec) <- specs
for(s in specs){
cdf <- df[df$SPEC == s,]
m <- median(cdf$REL.ALT1)
mean.spec[s] <- m
}
return(mean.spec)
}
Mmeans <- mean.freq(Msnp, SPEC)
Smeans <- mean.freq(Ssnp, SPEC)
Mixmeans <- mean.freq(Mixsnp, SPEC)
print(Mmeans)
print(Smeans)
print(Mixmeans)
linetype <- c("solid","solid",  "dashed")
color <- c("red","blue", "darkgreen")
digits <- 4
size <- 0.5
alpha <- c(0.9, 0.9, 0.5)
textsize <- 5
mplot + geom_hline(yintercept = Mmeans, linetype = linetype, color = color, size = size, alpha = alpha) +
geom_text(aes(0, Mmeans, label = as.character(round(Mmeans, digits = digits)),
vjust = c(+2,-2,+2), hjust = c(-1,-1,-4)),
size = textsize, color = color)
splot + geom_hline(yintercept = Smeans, linetype = linetype, color = color, size = size, alpha = alpha) +
geom_text(aes(0, Smeans, label = as.character(round(Smeans, digits = digits)),
vjust = c(+2,-2,+2), hjust = c(-1,-1,-4)),
size = textsize, color = color)
bplot + geom_hline(yintercept = Mixmeans, linetype = linetype, color = color, size = size, alpha = alpha) +
geom_text(aes(0, Mixmeans, label = as.character(round(Mixmeans, digits = digits)),
vjust = c(+2,+2,+2), hjust = c(-1,-1,-4)),
size = textsize, color = color)
bac
bac[bac$ISO == "iIsolate1"]
bac[bac$ISO == "iIsolate1",]
devtools::document()
library(bacsnp)
R.version
library(bacsnp)
devtools::document()
library(bacsnp)
browseVignettes("S4Vectors")
library(bacsnp)
bac
a <- system.file("extdata", "bac.vcf", package="bacsnp")
a
readVcf(a)
VariantAnnotation::readVcf(a)
b <- VariantAnnotation::readVcf(a)
vcf_to_df(b)
devtools::document()
devtools::document()
library(bacsnp)
citation("bacsnp")
?bacsnp
devtools::document()
library(bacsnp)
devtools::document()
library(bacsnp)
?ggplot
bac
is.data.frame(bac)
bac[bac$ISO == "iIsolate1",]
bac
bac[1:75,]
library(bacsnp)
library(bacsnp)
devtools::use_testthat()
usethis::use_testthat()
devtools::test()
file.exists("~/.ssh/id_rsa.pub")
